(self.webpackChunkgame_score_sdk=self.webpackChunkgame_score_sdk||[]).push([[70],{4340:(t,e,r)=>{"use strict";r.d(e,{D:()=>i});const i=()=>Promise.resolve({success:!1,rating:0,error:""})},501:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});var i=r(4340),n=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};class s{constructor(){this.canAddShortcut=!1,this.canRequestReview=!1,this.isAlreadyReviewed=!1}addShortcut(){return n(this,void 0,void 0,(function*(){return!1}))}requestReview(){return(0,i.D)()}requestGameUrl(){return n(this,void 0,void 0,(function*(){}))}}},5572:(t,e,r)=>{"use strict";r.d(e,{VK:()=>i,yl:()=>n});const i={success:!0,payload:{}},n={success:!1,payload:{}}},2712:(t,e,r)=>{"use strict";r.d(e,{aD:()=>l,FU:()=>p,hc:()=>v});const i=(t,e)=>({type:t,getLink:e}),n=i("facebook",(t=>`//www.facebook.com/sharer/sharer.php?u=${t.url}`)),s=i("whatsapp",(t=>`//api.whatsapp.com/send?text=${t.text}%20${t.url}`)),o=i("telegram",(t=>`//t.me/share/url?url=${t.url}&text=${t.text}`)),a=i("vkontakte",(t=>`//vk.com/share.php?url=${t.url}&title=${t.text}&image=${t.image}`)),c=i("twitter",(t=>`//twitter.com/share?text=${t.text}&url=${t.url}`)),d=i("odnoklassniki",(t=>`//connect.ok.ru/offer?url=${t.url}&title=${t.text}&imageUrl=${t.image}`)),u=i("viber",(t=>`viber://forward?text=${t.text}%20${t.url}`)),h=i("moymir",(t=>`//connect.mail.ru/share?url=${t.url}&title=${t.text}&image_url=${t.image}`)),l=[s,o,a,d,u,h],p=[n,c,o,s,u],v=[n,c,o,s,u,a,d,h]},4917:(t,e,r)=>{"use strict";function i({src:t,check:e}){return new Promise(((r,i)=>{let n=0;if(null==e?void 0:e(window))return void r();function s(){e?e(window)&&(clearInterval(n),r()):r()}if(document.querySelector(`script[src="${t}"]`)&&e)return void(n=setInterval(s,100));var o=document.getElementsByTagName("script")[0];const a=document.createElement("script");a.src=t,a.onload=s,a.onerror=i,o.parentNode.insertBefore(a,o),e&&(n=setInterval(s,100))}))}r.d(e,{Z:()=>i})},5092:(t,e,r)=>{"use strict";r.d(e,{M:()=>i});const i=(t,e,r,i)=>{var n;const s=(window.innerWidth-r)/2,o=(window.innerHeight-i)/2,a=window.open(t,e,`scrollbars=yes,\n        width=${r},\n        height=${i},\n        top=${o},\n        left=${s}\n        `);return null===(n=a.focus)||void 0===n||n.call(a),a}},209:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});var i=r(6558);const n={stringify:t=>btoa(encodeURIComponent(JSON.stringify(t))),parse(t){if(!t)return{};const e=function(t){try{return JSON.parse(decodeURIComponent(atob(t)||"{}"))}catch(t){return""}}(t);return Object.keys(e).length>0?e:JSON.parse(function(t){try{return JSON.parse(atob(t)||"{}")}catch(t){return""}}(t)||"{}")},addShareParamsToUrl(t,e){try{const r=new URL(t);return Object.entries(e).forEach((([t,e])=>{r.searchParams.set(t,e)})),r.href}catch(e){i.kg.error("Invalid URL",t,e)}return t}}},558:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>I});var i=r(8293),n=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};class s{constructor(t){this.sdk=t,this.hasCredetials=!1,this.isAccountLinked=!0,this.isAuthorizedAtPlatform=!0}get userId(){return String(this.sdk.userId)}getPlayerAuthInfo(){return n(this,void 0,void 0,(function*(){const t=(0,i._)();yield this.sdk.ready;const{searchParams:e}=new URL(window.location.href),r={},n=[];e.forEach(((t,e)=>{n.push(e),r[e]=t})),r._gpOrderedKeys=n;const s=yield this.sdk.getLoginStatus();return this.hasCredetials=s>1,t.done(r),t.ready}))}getPlayerContext(){return n(this,void 0,void 0,(function*(){const t=yield this.getPlayerAuthInfo();return{platformData:t,key:t.userId}}))}loginPlayer(){return n(this,void 0,void 0,(function*(){return yield this.sdk.ready,yield this.sdk.login(),this.sdk.getPlayer()}))}linkAccount(){return n(this,void 0,void 0,(function*(){return Promise.resolve(!0)}))}getPlayer(){return n(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.getPlayer()}))}publishRecord(t){}isPlatformAvatar(t){return t.includes("avatar.my.games")}}var o=r(2712),a=r(5942),c=r(5572);class d{constructor(t){this.sdk=t,this.hasIntegratedAuth=!0,this.isExternalLinksAllowed=!0,this.isSecretCodeAuthAvailable=!1,this._hasAuthModal=!0,this.type=a.z.VK_PLAY,this.socialNetworks=o.aD,this.isSupportsImageUploading=!1,this.hasAccountLinkingFeature=!1}getSDK(){return this.sdk}getNativeSDK(){return this.sdk.sdk}requestPermissions(){return t=this,e=void 0,i=function*(){return c.VK},new((r=void 0)||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}));var t,e,r,i}uploadImage(){return null}}var u,h=r(4917),l=r(6558),p=r(9696),v=r(5092),f=r(8866),y=r(209),g=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};!function(t){t[t.GUEST=0]="GUEST",t[t.NOT_REGISTERED=1]="NOT_REGISTERED",t[t.REGISTERED=2]="REGISTERED",t[t.REGISTERED_AND_HAS_PURCHASE=3]="REGISTERED_AND_HAS_PURCHASE"}(u||(u={}));class m{constructor(t,e){this.config=t,this.gp=e;const{searchParams:r}=new URL(window.location.href);this.userId=r.get("uid"),this.authKey=r.get("sign"),this.appId=r.get("appid");const i=(r.get("lang")||"").split("_")[0];this.lang=Object.values(p.Uo).includes(i)?i:null;try{const t=new URL(window.location.href).searchParams.get("_gpParams");t&&(this.shareParams=y.Z.parse(t))}catch(t){l.kg.error(t)}}get appUrl(){return`https://vkplay.ru/app/${this.appId}`}init(t){return g(this,void 0,void 0,(function*(){!this.appId&&t&&(this.appId=t);const e=[(0,h.Z)({src:`//vkplay.ru/app/${this.appId}/static/mailru.core.js`,check:t=>"iframeApi"in t}).catch(l.kg.error)],r=(0,i._)({timeout:1e4});return Promise.all(e).then((()=>g(this,void 0,void 0,(function*(){const t=window.iframeApi;void 0!==t?t({appid:this.appId,getLoginStatusCallback:t=>{this.getLoginTransaction.done(t)},userInfoCallback:t=>{this.userInfoTransaction.done(t)},userProfileCallback:t=>{this.userProfileTransaction.done(t)},registerUserCallback:t=>{var e;null===(e=this.registerUserTransaction)||void 0===e||e.done(t)},paymentFrameUrlCallback:t=>{},getAuthTokenCallback:t=>{},paymentReceivedCallback:t=>{this.paymentReceivedTransaction.done(t)},paymentWindowClosedCallback:()=>{},userConfirmCallback:()=>{},adsCallback:t=>{this.showAdsTransaction.done(t)}}).then((t=>g(this,void 0,void 0,(function*(){this.sdk=t;try{(yield this.getLoginStatus())===u.NOT_REGISTERED&&(yield this.registerUser())&&(this.isRegisteredInCurrentSession=!0)}catch(t){l.kg.error(t)}r.done(this)}))),r.abort):r.abort("Cannot find iframeApi function, are we inside an iframe?")})))),this.ready=r.ready,this.ready}))}getLoginStatus(){return g(this,void 0,void 0,(function*(){return this.getLoginTransaction=(0,i._)(),this.sdk.getLoginStatus(),(yield this.getLoginTransaction.ready).loginStatus||0}))}registerUser(){return g(this,void 0,void 0,(function*(){return this.registerUserTransaction=(0,i._)(),this.sdk.registerUser(),"ok"===(yield this.registerUserTransaction.ready).status}))}login(){return g(this,void 0,void 0,(function*(){if(this.isRegisteredInCurrentSession)return this.sdk.reloadWindow();yield this.sdk.authUser()}))}getPlayer(){return g(this,void 0,void 0,(function*(){this.userProfileTransaction=(0,i._)(i.s),yield this.ready,this.sdk.userProfile();const t=yield this.userProfileTransaction.ready,{uid:e,nick:r,avatar:n}=t||{};return{id:e||"",name:r||"",photoSmall:n||"",photoMedium:n||"",photoLarge:n||"",signature:this.authKey}}))}showRewardedVideo(){return g(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!1}),this.showAdsTransaction.ready.then((t=>"adCompleted"===(null==t?void 0:t.type)))}))}showPreloader(){return g(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!0}),this.showAdsTransaction.ready.then((t=>"adError"!==(null==t?void 0:t.type)))}))}showFullscreen(){return g(this,void 0,void 0,(function*(){return this.showAdsTransaction=(0,i._)(),yield this.ready,this.sdk.showAds({interstitial:!0}),this.showAdsTransaction.ready.then((t=>"adError"!==(null==t?void 0:t.type)))}))}purchase(t){var e;return g(this,void 0,void 0,(function*(){if(this.paymentReceivedTransaction=(0,i._)(),!this.gp.player.isLoggedInByPlatform)try{yield this.gp.player.login()}catch(t){return}this.sdk.isRegisteredInCurrentSession&&(yield this.sdk.reloadWindow());try{const e=yield this.gp._paymentsService.getPaymentLink({productId:t.id});if(e){const t=(0,v.M)(e.link,"",830,622),r=setInterval((()=>g(this,void 0,void 0,(function*(){t.closed&&(clearInterval(r),yield(0,f.Z)(4e3),this.paymentReceivedTransaction.abort("purchase_window_closed"))}))),1e3)}}catch(t){"not_authorized"===t&&this.gp.player.isLoggedInByPlatform&&(yield this.sdk.reloadWindow()),this.paymentReceivedTransaction.abort((null===(e=null==t?void 0:t.error_data)||void 0===e?void 0:e.error_reason)||t)}return this.paymentReceivedTransaction.ready}))}addShareParamsToUrl(t,e){return y.Z.addShareParamsToUrl(t,{_gpParams:y.Z.stringify(e)})}makeShareUrl(t){return this.addShareParamsToUrl(this.gp.app.url,t)}getShareParam(t){return this.shareParams?this.shareParams[t]:""}}var w=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};class k{constructor(t){this.sdk=t,this.isRewardedAvailable=!0,this.isPreloaderAvailable=!0,this.isFullscreenAvailable=!0,this.isStickyAvailable=!1,this.stickyBannerConfig={isOverlapping:!1,height:0},this.canShowFullscreenBeforeGamePlay=!0}showPreloader(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showPreloader().catch((()=>!1))}))}showFullscreen(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showFullscreen().catch((()=>!1))}))}showRewardedVideo(){return w(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.showRewardedVideo().catch((()=>!1))}))}showSticky(t){return w(this,void 0,void 0,(function*(){return!1}))}refreshSticky(t){return w(this,void 0,void 0,(function*(){return!1}))}closeSticky(){return w(this,void 0,void 0,(function*(){}))}}var P=r(501);class S{constructor(t){this.sdk=t,this.isSupportsShare=!0,this.isSupportsNativeShare=!1,this.isSupportsNativePosts=!1,this.isSupportsNativeInvite=!1,this.isSupportsNativeCommunityJoin=!1,this.canJoinCommunity=!1,this.isSupportShareParams=!0}get shareParams(){return this.sdk.shareParams}share(t){return Promise.resolve(!1)}post(t){return Promise.resolve(!1)}invite(t){return Promise.resolve(!1)}joinCommunity(){return Promise.resolve(!1)}getCommunityLink(t){return t}addShareParamsToUrl(t,e){return this.sdk.addShareParamsToUrl(t,e)}makeShareUrl(t){return this.sdk.makeShareUrl(t)}getShareParam(t){return this.sdk.getShareParam(t)}}var A=function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const R={[p.Uo.RU]:"Руб",[p.Uo.EN]:"Rub"};class b{constructor(t){this.sdk=t,this.isSupportsSubscriptions=!1,this.isSupportsPayments=!0,this.isServerValidation=!0}mapProducts(t,e){return A(this,void 0,void 0,(function*(){return e.map((e=>Object.assign(Object.assign({},e),{currencySymbol:R[t.language]||R[p.Uo.EN],currency:"RUB"})))}))}consumeAllExpired(t,e,r){return A(this,void 0,void 0,(function*(){}))}fetchPurchases(){return A(this,void 0,void 0,(function*(){return{payload:{},purchases:[]}}))}purchase(t){return A(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}consume(t){return A(this,void 0,void 0,(function*(){return{}}))}subscribe(t){return A(this,void 0,void 0,(function*(){return yield this.sdk.ready,this.sdk.purchase(t)}))}unsubscribe(t,e){return A(this,void 0,void 0,(function*(){return{}}))}}function I(t){return e=this,r=void 0,n=function*(){const e=new m({},t.gp),r=[];r.push(t.setupStorage([]),t.fetchConfig(e.lang)),e.appId&&r.push(e.init());const i=(yield Promise.all(r))[1];e.appId||(yield e.init(i.platformConfig.appId).catch(l.kg.error));const n=new s(e);return{adsAdapter:new k(e),appAdapter:new P.Z,playerAdapter:n,platformAdapter:new d(e),socialsAdapter:new S(e),paymentsAdapter:new b(e),projectConfig:i}},new((i=void 0)||(i=Promise))((function(t,s){function o(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(o,a)}c((n=n.apply(e,r||[])).next())}));var e,r,i,n}}}]);